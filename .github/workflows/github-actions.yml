name: Deployment

on:
  workflow_dispatch:
    inputs:
      release:
        description: 'Please provide the release version'
        required: true

jobs:
  deploy:
    env:
      POD_KUBECONFIG: '${{ github.workspace }}/.kube/pod-kubeconfig'
    name: Deployment
    runs-on: [self-hosted, kube-deploy] 

    steps:
    
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          path: custom-workspace  # Set the custom workspace directory

      - name: Configure AWS Account
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: arn:aws:iam::977186631846:role/GitHubActionsEKSRole
          aws-region: us-east-2

      - name: Update Kubeconfig
        run: aws eks update-kubeconfig --name naapdev --region us-east-2
